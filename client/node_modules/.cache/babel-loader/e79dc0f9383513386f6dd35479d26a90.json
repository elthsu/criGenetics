{"ast":null,"code":"var _jsxFileName = \"/Users/eltonhsu/cri/challenge/client/src/Admin.js\";\nimport React, { useEffect, useState } from 'react';\nimport './App.css';\nimport axios from 'axios';\n\nfunction Admin(props) {\n  const [trackers, setTrackers] = useState([]);\n  const [newUrl, setNewUrl] = useState(\"\");\n  const [newRedirect1, setNewRedirect1] = useState(\"\");\n  const [newRedirect2, setNewRedirect2] = useState(\"\");\n  const [reloadData, setReloadData] = useState(false);\n  const [userId, setUserId] = useState(\"\");\n  const [timer, setTimer] = useState(\"\");\n  useEffect(() => {\n    setUserId(localStorage.getItem(\"cri_genetics_userId\"));\n    axios.get(\"/getTrackers\").then(data => {\n      setTrackers(data.data);\n    });\n    setTimer(setInterval(() => {\n      setReloadData(true);\n    }, 5000));\n  }, []);\n  useEffect(() => {\n    return () => {\n      clearInterval(timer);\n    };\n  }, []);\n  useEffect(() => {\n    if (reloadData) {\n      axios.get(\"/getTrackers\").then(data => {\n        setTrackers(data.data);\n        setReloadData(false);\n      });\n    }\n  }, [reloadData]);\n\n  const handleNewTracker = () => {\n    axios.post(\"/addTracker\", {\n      url: newUrl,\n      redirect1: newRedirect1,\n      redirect2: newRedirect2\n    }).then(data => {\n      if (data.data === \"tracker added\") setReloadData(true);\n      setNewUrl(\"\");\n      setNewRedirect1(\"\");\n      setNewRedirect2(\"\");\n    });\n  };\n\n  const handleUnique = (trackerId, redirectRoute, userId) => {\n    if (trackers) {\n      let temp = trackers.filter(filtered => {\n        return filtered.clicks.length > 0;\n      }).filter(innerFilter => {\n        return trackerId === innerFilter._id;\n      }).map(mapped => {\n        let inner = mapped.clicks.filter(filterItem => {\n          return filterItem.redirect === redirectRoute;\n        });\n        return inner;\n      });\n\n      if (!temp[0] || temp[0].length === 0) {\n        return 0;\n      } else {\n        let uniqueCount = [];\n\n        for (let i = 0; i < temp[0].length; i++) {\n          if (uniqueCount.indexOf(temp[0][i].userId) === -1) {\n            uniqueCount.push(temp[0][i].userId);\n          }\n        }\n\n        return uniqueCount.length;\n      }\n    }\n  };\n\n  const handleCampaignToggle = trackerId => {\n    axios.post(\"/toggleCampaign\", {\n      trackerId\n    }).then(response => {\n      axios.get(\"/getTrackers\").then(data => {\n        setTrackers(data.data);\n      });\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"App-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: 'https://www.crigenetics.com/hubfs/html/ancestry/images/dna-logo.png',\n    className: \"App-logo\",\n    alt: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tracker-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, trackers.map(tracker => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: tracker._id,\n      className: \"tracker\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"routes\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 19\n      }\n    }, \"URL:\"), tracker.url, \" - \", /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => handleCampaignToggle(tracker._id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 50\n      }\n    }, tracker.trackerOn ? \"ON\" : \"OFF\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"routes\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 19\n      }\n    }, \"Redirect 1:\"), tracker.redirect1), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"stats\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 19\n      }\n    }, \"Unique:\", handleUnique(tracker._id, tracker.redirect1, userId)), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 19\n      }\n    }, \"Total: \", tracker.clicks.filter(filterItem => {\n      return filterItem.redirect === tracker.redirect1;\n    }).map(mapped => {\n      return mapped;\n    }).length), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 19\n      }\n    }, \"Conversions: \", tracker.conversions.filter(filterItem => {\n      return filterItem.campaign === tracker.redirect1;\n    }).map(mapped => {\n      return mapped;\n    }).length)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"routes\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 19\n      }\n    }, \"Redirect 2:\"), tracker.redirect2), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"stats\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 19\n      }\n    }, \"Unique: \", handleUnique(tracker._id, tracker.redirect2)), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 19\n      }\n    }, \"Total: \", tracker.clicks.filter(filterItem => {\n      return filterItem.redirect === tracker.redirect2;\n    }).map(mapped => {\n      return mapped;\n    }).length), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 19\n      }\n    }, \"Conversions: \", tracker.conversions.filter(filterItem => {\n      return filterItem.campaign === tracker.redirect2;\n    }).map(mapped => {\n      return mapped;\n    }).length)));\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"add-tracker\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"routes\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 13\n    }\n  }, \"URL:\"), \" \", /*#__PURE__*/React.createElement(\"input\", {\n    value: newUrl,\n    onChange: event => {\n      setNewUrl(event.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"routes\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }\n  }, \"Redirect 1:\"), \" \", /*#__PURE__*/React.createElement(\"input\", {\n    value: newRedirect1,\n    onChange: event => {\n      setNewRedirect1(event.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 36\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"routes\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }, \"Redirect 2:\"), \" \", /*#__PURE__*/React.createElement(\"input\", {\n    value: newRedirect2,\n    onChange: event => {\n      setNewRedirect2(event.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 36\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleNewTracker,\n    style: {\n      alignSelf: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }\n  }, \"Add New Tracker\"))));\n}\n\nexport default Admin;","map":{"version":3,"sources":["/Users/eltonhsu/cri/challenge/client/src/Admin.js"],"names":["React","useEffect","useState","axios","Admin","props","trackers","setTrackers","newUrl","setNewUrl","newRedirect1","setNewRedirect1","newRedirect2","setNewRedirect2","reloadData","setReloadData","userId","setUserId","timer","setTimer","localStorage","getItem","get","then","data","setInterval","clearInterval","handleNewTracker","post","url","redirect1","redirect2","handleUnique","trackerId","redirectRoute","temp","filter","filtered","clicks","length","innerFilter","_id","map","mapped","inner","filterItem","redirect","uniqueCount","i","indexOf","push","handleCampaignToggle","response","tracker","trackerOn","conversions","campaign","event","target","value","alignSelf"],"mappings":"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","sourcesContent":["import React, { useEffect, useState} from 'react';\nimport './App.css';\nimport axios from 'axios'\n\nfunction Admin(props) {\n  \n  const [trackers, setTrackers] = useState([])\n\n  const [newUrl, setNewUrl] = useState(\"\")\n  const [newRedirect1, setNewRedirect1] = useState(\"\")\n  const [newRedirect2, setNewRedirect2] = useState(\"\")\n  const [reloadData, setReloadData] = useState(false)\n  const [userId, setUserId] = useState(\"\")\n\n  const [timer, setTimer] = useState(\"\")\n\n\n\n  useEffect(()=>{\n    setUserId(localStorage.getItem(\"cri_genetics_userId\"))\n    axios.get(\"/getTrackers\").then(data=>{\n      setTrackers(data.data)\n    })\n    setTimer(setInterval(()=>{\n      setReloadData(true)\n    }, 5000))\n  }, [])\n\n  useEffect(()=>{\n    return ()=>{\n      clearInterval(timer)\n    }\n  }, [])\n\n  useEffect(()=>{\n    if(reloadData){\n      axios.get(\"/getTrackers\").then(data=>{\n        setTrackers(data.data)\n        setReloadData(false)\n      })\n    }\n  }, [reloadData])\n\n  const handleNewTracker = () => {\n    axios.post(\"/addTracker\", {url: newUrl, redirect1:newRedirect1, redirect2:newRedirect2}).then(data=>{\n      if(data.data === \"tracker added\")\n      setReloadData(true)\n      setNewUrl(\"\")\n      setNewRedirect1(\"\")\n      setNewRedirect2(\"\")\n    })\n  }\n\n  const handleUnique =  (trackerId, redirectRoute, userId) => {\n    if(trackers) {\n      let temp = trackers.filter(filtered=>{\n        return filtered.clicks.length > 0\n      }).filter(innerFilter=>{\n        return trackerId === innerFilter._id\n      }).map(mapped=>{\n        let inner = mapped.clicks.filter(filterItem => {\n          return filterItem.redirect === redirectRoute\n        })\n        return inner\n      })\n      if(!temp[0] || temp[0].length === 0){\n        return 0\n      }\n      else {\n        let uniqueCount = []\n        for (let i = 0; i < temp[0].length; i++) {\n          if(uniqueCount.indexOf(temp[0][i].userId) === -1){\n            uniqueCount.push(temp[0][i].userId)\n          }\n        }\n        return uniqueCount.length\n      }\n    }\n  }\n\n  const handleCampaignToggle = (trackerId) => {\n    axios.post(\"/toggleCampaign\", {trackerId}).then(response=>{\n      axios.get(\"/getTrackers\").then(data=>{\n        setTrackers(data.data)\n      })\n    })\n  }\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={'https://www.crigenetics.com/hubfs/html/ancestry/images/dna-logo.png'} className=\"App-logo\" alt=\"logo\" />\n      </header>\n      <div className=\"tracker-container\">\n        {\n          trackers.map(tracker=>{\n            return (\n              <div key={tracker._id} className=\"tracker\">\n                <div className=\"routes\">\n                  <div>URL:</div>{tracker.url} - <button onClick={()=>handleCampaignToggle(tracker._id)}>{tracker.trackerOn ? \"ON\" : \"OFF\"}</button>\n                </div>\n                <div className=\"routes\">\n                  <div>Redirect 1:</div>{tracker.redirect1}\n                </div>\n                <div className=\"stats\">\n                  <div>\n                    Unique:{handleUnique(tracker._id, tracker.redirect1, userId)}\n                  </div>\n                  <div>\n                    Total: {tracker.clicks.filter(filterItem => {\n                      return filterItem.redirect === tracker.redirect1\n                    }).map(mapped=>{\n                      return mapped\n                    }).length}\n                  </div>\n                  <div>\n                    Conversions: {tracker.conversions.filter(filterItem=>{\n                      return filterItem.campaign === tracker.redirect1\n                    }).map(mapped=>{\n                      return mapped\n                    }).length}\n                  </div>\n                </div>\n                <div className=\"routes\">\n                  <div>Redirect 2:</div>{tracker.redirect2}\n                </div>\n                <div className=\"stats\">\n                  <div>\n                    Unique: {handleUnique(tracker._id, tracker.redirect2)}\n                  </div>\n                  <div>\n                    Total: {tracker.clicks.filter(filterItem => {\n                      return filterItem.redirect === tracker.redirect2\n                    }).map(mapped=>{\n                      return mapped\n                    }).length}\n                  </div>\n                  <div>\n                    Conversions: {tracker.conversions.filter(filterItem=>{\n                      return filterItem.campaign === tracker.redirect2\n                    }).map(mapped=>{\n                      return mapped\n                    }).length}\n                  </div>\n                </div>\n              </div>\n            )\n          })\n        }\n        <div className=\"add-tracker\">\n          <div className=\"routes\">\n            <div>URL:</div> <input value={newUrl} onChange={(event)=>{setNewUrl(event.target.value)}}/>\n          </div>\n          <div className=\"routes\">\n            <div>Redirect 1:</div> <input value={newRedirect1} onChange={(event)=>{setNewRedirect1(event.target.value)}}/>\n          </div>\n          <div className=\"routes\">\n            <div>Redirect 2:</div> <input value={newRedirect2} onChange={(event)=>{setNewRedirect2(event.target.value)}}/>\n          </div>\n          <button onClick={handleNewTracker} style={{alignSelf: \"center\"}}>Add New Tracker</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Admin;\n"]},"metadata":{},"sourceType":"module"}